overrides:
  ceph-deploy:
    prepare_activate: true
    conf:
      client:
        log file: /var/log/ceph/ceph-$name.$pid.log
      mon:
        debug mon: 1
        debug ms: 20
        debug paxos: 20
      osd:
        debug filestore: 20
        debug journal: 20
        debug ms: 1
        debug osd: 20
      global:
        mon pg warn min per osd: 2
        osd pool default size: 2
roles:
- - mon.a
- - mon.b
- - mon.c
  - osd.0
  - osd.1
- - osd.2
  - osd.3
- - client.0
tasks:
- ssh-keys:
- ceph-deploy:
    rhbuild: '1.3.2' 
    fs: xfs
- parallel:
  - run-client-io
  - upgrade-mon-osd
upgrade-mon-osd:
  sequential:
  - ceph-deploy.upgrade:
      latest: true
      roles:
       - mon.a
  - sleep:
      duration: 60
  - ceph-deploy.upgrade:
      latest: true
      roles:
       - osd.2
run-client-io:
  sequential:
  - radosbench:
      clients: [client.0]
      time: 600
  - radosbench:
      clients: [client.0]
      time: 600
  - radosbench:
      clients: [client.0]
      time: 600
  - radosbench:
      clients: [client.0]
      time: 600